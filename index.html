<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weather</title>
    <style>
      :root {
        --bg-color: #040d12;
        --blur-bg-color: rgba(255, 255, 255, 0);
        --card-bg-color: #ffffff50;
        --container-color: #ffffff15;
        --image-bg-color: rgb(20, 20, 20);
        --font-color: #f2f2f2;
        --hovered-font-color: #f2f2f2;
        --active-font-color: #f2f2f2;
        --red-font: crimson;
        --bar-color: #333333;
        --thin-border-color: rgba(255, 255, 255, 0.15);
        --box-shadow-color: rgba(0, 0, 0, 0.155);
        --text-shadow-color: black;
        --icon-color: #333333;
        --button-color: #5f7470;
        --transparent-button-color: rgba(255, 255, 255, 0);
        --hovered-button-color: #73877b;
        --active-button-color: #839788;
        --footer-bg-color: rgb(20, 20, 20);
      }

      * {
        padding: 0px;
        margin: 0px;
        box-sizing: border-box;
        outline: none;
        border: none;
      }

      body {
        background-color: var(--bg-color);
        /* background-color: white; */
        font-family: Arial, Helvetica, sans-serif;
        color: var(--font-color);
        min-height: 100dvh;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      img {
        max-width: 100%;
      }

      main {
        background-image: url(images/bg.jpg);
        background-size: cover;
        background-repeat: no-repeat;
        background-size: cover;
        background-position: center center;
        background-repeat: no-repeat;
        position: relative;
        min-height: 100dvh;
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100%;
      }

      .container {
        background-image: url(images/weatherBg.jpg);
        background-size: cover;
        background-position: center center;
        background-repeat: no-repeat;
        padding: 2rem;
        border-radius: 1rem;
        box-shadow: 0 0 1rem var(--box-shadow-color),
          0 0 2rem var(--box-shadow-color);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        gap: 4rem;
      }

      .searchBar {
        display: flex;
      }

      #search {
        background-color: transparent;
        border: 0.1rem solid var(--bar-color);
        color: var(--font-color);
        border-radius: 1rem 0 0 1rem;
      }

      #search:enabled {
        padding: 0.5rem 1rem;
        font-size: 1rem;
      }

      #go {
        padding: 0 1rem;
        border-radius: 0 1rem 1rem 0;
        background-color: var(--button-color);
        color: var(--font-color);
        font-size: 1rem;
      }

      .weatherInfo {
        display: none;
      }

      .para {
        font-size: 1.25rem;
        margin-bottom: 1rem;
      }

      .cityName {
        font-size: 2rem;
      }

      .temp {
        display: flex;
        justify-content: center;
        align-items: center;
      }

      #invalidInput {
        font-size: 1.5rem;
        display: none;
      }

      .info {
        display: flex;
        gap: 2rem;
      }
    </style>
  </head>

  <body>
    <main>
      <div class="container">
        <h1>Weather App</h1>
        <div class="searchBar">
          <input type="text" id="search" />
          <button id="go">Go</button>
        </div>
        <p id="invalidInput"></p>
        <div class="weatherInfo">
          <img id="sky" src="" alt="" />
          <p class="para" id="cityPara">City</p>
          <p class="para cityName" id="city"></p>
          <div class="temp">
            <img src="/images/temperature.svg" alt="" />
            <p class="para" id="tempPara">Temperature</p>
          </div>
          <p class="para" id="temp"></p>
          <div class="info">
            <div class="wind">
              <img src="images/airy.svg" alt="" />
              <p class="para" id="windPara"></p>
              <p class="para" id="windSpeed"></p>
            </div>
            <div class="humidity">
              <img src="images/humidity.svg" alt="this is an image" />

              <p class="para" id="humidityPara">Humidity</p>
              <p class="para" id="humidity"></p>
            </div>
          </div>
        </div>
      </div>
    </main>
  </body>
  <script>
    const city = document.querySelector("#search");
    function dofunc() {
      let cityName = city.value;
      request(cityName);
    }

    go.addEventListener("click", function (e) {
      e.preventDefault();
      dofunc();
    });
    city.addEventListener("keydown", function (e) {
      // e.preventDefault();
      console.log("hello");
      let cityName = city.value;

      if (e.key === "Enter") {
        request(cityName);
      }
    });

    city.addEventListener("keydown", function (e) {
      // e.preventDefault();
      if (e.key === "Enter") {
        dofunc();
      }
      // console.log("hello");
    });

    async function request(value) {
      // const api = "https://api.openweathermap.org/data/2.5/weather?";
      // const apiKey = "baf121166603d8940559c2dfd69ff368";

      const dCity = document.querySelector("#city");
      const temp = document.querySelector("#temp");
      const weatherInfo = document.querySelector(".weatherInfo");
      const info = document.querySelector(".info");
      const windSpeed = document.querySelector("#windSpeed");
      const humidity = document.querySelector("#humidity");
      const sky = document.querySelector("#sky");

      let data = await fetch(
        `https://api.openweathermap.org/data/2.5/weather?q=${value}&units=metric&appid=baf121166603d8940559c2dfd69ff368`
      );

      let weatherData = await data.json();

      try {
        console.log(weatherData.weather[0].icon);
        // const skyUrl = `https://openweathermap.org/img/wn/${weatherData.weather[0].icon}@2x.png`;

        weatherInfo.style.display = "block";
        sky.src = `https://openweathermap.org/img/wn/${weatherData.weather[0].icon}@2x.png`;
        // sky.src =   skyUrl;

        dCity.innerHTML = weatherData.name;
        temp.innerHTML = Math.round(weatherData.main.temp) + ` â„ƒ`;
        windSpeed.innerHTML =
          (weatherData.wind.speed * 3.6).toFixed(2) + ` km/h`;
        humidity.innerHTML = weatherData.main.humidity + ` %`;
        invalidInput.style.display = "none";

        // console.log(typeof data);
        // console.log(typeof weatherData);
        console.log(weatherData);
        // console.log((temp.innerHTML = weatherData.main.temp));
      } catch (error) {
        const invalidInput = document.querySelector("#invalidInput");
        invalidInput.style.display = "block";
        invalidInput.innerHTML = `Input a valid CITY`;
        weatherInfo.style.display = "none";
      }
    }
  </script>
</html>
